/*! 
 Build based on gin-vue-admin 
 Time : 1718987800000 */
import{o as e,h as a,w as l,g as t,k as o,E as i,d as s,_ as r,a as p,c as n,b as u,N as d,O as c,G as m,b2 as v,t as f,ap as B,l as g,J as b}from"./087AC4D233B64EB0index.72fd2312.js";/* empty css                               *//* empty css                                *//* empty css                                   *//* empty css                              *//* empty css                            *//* empty css                               *//* empty css                                  *//* empty css                               */import{E as C,a as y}from"./087AC4D233B64EB0table-column.a0d188fb.js";import"./087AC4D233B64EB0checkbox.ca4c4f80.js";/* empty css                                *//* empty css                                  *//* empty css                               */import{g as h,d as E,f as A,a as D,u as _,c as j,b as w}from"./087AC4D233B64EB0api.9e955f26.js";import{t as x}from"./087AC4D233B64EB0stringFun.647a78e9.js";import{_ as V}from"./087AC4D233B64EB0warningBar.90f1d9d1.js";import{t as k}from"./087AC4D233B64EB0doc.46160848.js";/* empty css                               *//* empty css                                 */import{E as I}from"./087AC4D233B64EB0index.e6ff289d.js";import{a as T,E as U}from"./087AC4D233B64EB0index.7b396154.js";import{E as S,a as G}from"./087AC4D233B64EB0index.3d51996d.js";import{E as O}from"./087AC4D233B64EB0index.111d928a.js";import{E as z}from"./087AC4D233B64EB0index.1c56beac.js";import"./087AC4D233B64EB0index.ffab591b.js";import"./087AC4D233B64EB0index.a0571a5c.js";import"./087AC4D233B64EB0isUndefined.d281c39a.js";import"./087AC4D233B64EB0_baseIteratee.e71013e5.js";import"./087AC4D233B64EB0_Uint8Array.d3e78e14.js";import"./087AC4D233B64EB0isEqual.add17071.js";import"./087AC4D233B64EB0hasIn.391c448e.js";import"./087AC4D233B64EB0debounce.1e721c0b.js";import"./087AC4D233B64EB0_initCloneObject.253b0cea.js";import"./087AC4D233B64EB0index.063cc7d2.js";import"./087AC4D233B64EB0cloneDeep.182936bd.js";import"./087AC4D233B64EB0_baseClone.503fbc91.js";import"./087AC4D233B64EB0castArray.673ea73c.js";import"./087AC4D233B64EB0index.ea000fb0.js";import"./087AC4D233B64EB0strings.ee229cfb.js";import"./087AC4D233B64EB0use-dialog.3fba8604.js";const q={__name:"exportExcel",props:{templateId:{type:String,required:!0},condition:{type:Object,default:()=>({})},limit:{type:Number,default:0},offset:{type:Number,default:0},order:{type:String,default:""}},setup(s){const r=s,p=async()=>{if(""===r.templateId)return void o.error("组件未设置模板ID");const e=JSON.parse(JSON.stringify(r.condition));r.limit&&(e.limit=r.limit),r.offset&&(e.offset=r.offset),r.order&&(e.order=r.order);const a=Object.entries(e).map((([e,a])=>"".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(a)))).join("&"),l="".concat("/api","/sysExportTemplate/exportExcel?templateID=").concat(r.templateId).concat(a?"&"+a:"");console.log(l),window.location.href=l};return(o,s)=>{const r=i;return e(),a(r,{type:"primary",icon:"download",onClick:p},{default:l((()=>[t("导出")])),_:1})}}},P={__name:"exportTemplate",props:{templateId:{type:String,required:!0}},setup(s){const r=s,p=async()=>{if(""===r.templateId)return void o.error("组件未设置模板ID");const e="".concat("/api","/sysExportTemplate/exportTemplate?templateID=").concat(r.templateId);window.open(e,"_blank")};return(o,s)=>{const r=i;return e(),a(r,{type:"primary",icon:"download",onClick:p},{default:l((()=>[t("下载模板")])),_:1})}}},F={__name:"importExcel",props:{templateId:{type:String,required:!0}},emits:["on-success"],setup(r,{emit:p}){const n=r,u=p,d="".concat("/api","/sysExportTemplate/importExcel?templateID=").concat(n.templateId),c=e=>{0===e.code?(o.success("导入成功"),u("on-success")):o.error(e.msg)};return(o,r)=>{const p=i,n=I;return e(),a(n,{action:d,"show-file-list":!1,"on-success":c,multiple:!1},{default:l((()=>[s(p,{type:"primary",icon:"upload"},{default:l((()=>[t("导入")])),_:1})])),_:1})}}},N={class:"gva-search-box"},R={class:"gva-table-box"},J={class:"gva-btn-list"},H={class:"gva-pagination"},K={class:"flex justify-between items-center"},L={class:"text-lg"},Q=r(Object.assign({name:"Api"},{__name:"api",setup(r){const I=e=>{const a=X.value.filter((a=>a.value===e))[0];return a&&"".concat(a.label)},Q=p([]),W=p({path:"",apiGroup:"",method:"",description:""}),X=p([{value:"POST",label:"创建",type:"success"},{value:"GET",label:"查看",type:""},{value:"PUT",label:"更新",type:"warning"},{value:"DELETE",label:"删除",type:"danger"}]),Y=p(""),Z=p({path:[{required:!0,message:"请输入api路径",trigger:"blur"}],apiGroup:[{required:!0,message:"请输入组名称",trigger:"blur"}],method:[{required:!0,message:"请选择请求方式",trigger:"blur"}],description:[{required:!0,message:"请输入api介绍",trigger:"blur"}]}),$=p(1),M=p(0),ee=p(10),ae=p([]),le=p({}),te=()=>{le.value={}},oe=()=>{$.value=1,ee.value=10,pe()},ie=e=>{ee.value=e,pe()},se=e=>{$.value=e,pe()},re=({prop:e,order:a})=>{e&&("ID"===e&&(e="id"),le.value.orderKey=x(e),le.value.desc="descending"===a),pe()},pe=async()=>{const e=await h({page:$.value,pageSize:ee.value,...le.value});0===e.code&&(ae.value=e.data.list,M.value=e.data.total,$.value=e.data.page,ee.value=e.data.pageSize)};pe();const ne=e=>{Q.value=e},ue=async()=>{B.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const e=Q.value.map((e=>e.ID)),a=await E({ids:e});0===a.code&&(o({type:"success",message:a.msg}),ae.value.length===e.length&&$.value>1&&$.value--,pe())}))},de=async()=>{B.confirm("确定要刷新缓存吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const e=await A();0===e.code&&o({type:"success",message:e.msg})}))},ce=p(null),me=p("新增Api"),ve=p(!1),fe=e=>{switch(e){case"addApi":me.value="新增Api";break;case"edit":me.value="编辑Api"}Y.value=e,ve.value=!0},Be=()=>{ce.value.resetFields(),W.value={path:"",apiGroup:"",method:"",description:""},ve.value=!1},ge=async()=>{ce.value.validate((async e=>{if(e)switch(Y.value){case"addApi":0===(await j(W.value)).code&&o({type:"success",message:"添加成功",showClose:!0}),pe(),Be();break;case"edit":0===(await _(W.value)).code&&o({type:"success",message:"编辑成功",showClose:!0}),pe(),Be();break;default:o({type:"error",message:"未知操作",showClose:!0})}}))};return(r,p)=>{const h=g,E=T,A=S,_=G,j=i,x=U,Y=b,be=C,Ce=y,ye=O,he=z;return e(),n("div",null,[u("div",N,[s(x,{ref:"searchForm",inline:!0,model:le.value},{default:l((()=>[s(E,{label:"路径"},{default:l((()=>[s(h,{modelValue:le.value.path,"onUpdate:modelValue":p[0]||(p[0]=e=>le.value.path=e),placeholder:"路径"},null,8,["modelValue"])])),_:1}),s(E,{label:"描述"},{default:l((()=>[s(h,{modelValue:le.value.description,"onUpdate:modelValue":p[1]||(p[1]=e=>le.value.description=e),placeholder:"描述"},null,8,["modelValue"])])),_:1}),s(E,{label:"API组"},{default:l((()=>[s(h,{modelValue:le.value.apiGroup,"onUpdate:modelValue":p[2]||(p[2]=e=>le.value.apiGroup=e),placeholder:"api组"},null,8,["modelValue"])])),_:1}),s(E,{label:"请求"},{default:l((()=>[s(_,{modelValue:le.value.method,"onUpdate:modelValue":p[3]||(p[3]=e=>le.value.method=e),clearable:"",placeholder:"请选择"},{default:l((()=>[(e(!0),n(d,null,c(X.value,(l=>(e(),a(A,{key:l.value,label:"".concat(l.label,"(").concat(l.value,")"),value:l.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),s(E,null,{default:l((()=>[s(j,{type:"primary",icon:"search",onClick:oe},{default:l((()=>[t("查询")])),_:1}),s(j,{icon:"refresh",onClick:te},{default:l((()=>[t("重置")])),_:1})])),_:1})])),_:1},8,["model"])]),u("div",R,[u("div",J,[s(j,{type:"primary",icon:"plus",onClick:p[4]||(p[4]=e=>fe("addApi"))},{default:l((()=>[t("新增")])),_:1}),s(Y,{class:"cursor-pointer",onClick:p[5]||(p[5]=e=>m(k)("https://www.bilibili.com/video/BV1kv4y1g7nT?p=7&vd_source=f2640257c21e3b547a790461ed94875e"))},{default:l((()=>[s(m(v))])),_:1}),s(j,{icon:"delete",disabled:!Q.value.length,onClick:ue},{default:l((()=>[t("删除")])),_:1},8,["disabled"]),s(j,{icon:"Refresh",onClick:de},{default:l((()=>[t("刷新缓存")])),_:1}),s(P,{"template-id":"api"}),s(q,{"template-id":"api",limit:9999}),s(F,{"template-id":"api",onOnSuccess:pe})]),s(Ce,{data:ae.value,onSortChange:re,onSelectionChange:ne},{default:l((()=>[s(be,{type:"selection",width:"55"}),s(be,{align:"left",label:"id","min-width":"60",prop:"ID",sortable:"custom"}),s(be,{align:"left",label:"API路径","min-width":"150",prop:"path",sortable:"custom"}),s(be,{align:"left",label:"API分组","min-width":"150",prop:"apiGroup",sortable:"custom"}),s(be,{align:"left",label:"API简介","min-width":"150",prop:"description",sortable:"custom"}),s(be,{align:"left",label:"请求","min-width":"150",prop:"method",sortable:"custom"},{default:l((e=>[u("div",null,f(e.row.method)+" / "+f(I(e.row.method)),1)])),_:1}),s(be,{align:"left",fixed:"right",label:"操作",width:"200"},{default:l((e=>[s(j,{icon:"edit",type:"primary",link:"",onClick:a=>(async e=>{const a=await D({id:e.ID});W.value=a.data.api,fe("edit")})(e.row)},{default:l((()=>[t("编辑")])),_:2},1032,["onClick"]),s(j,{icon:"delete",type:"primary",link:"",onClick:a=>(async e=>{B.confirm("此操作将永久删除所有角色下该api, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{0===(await w(e)).code&&(o({type:"success",message:"删除成功!"}),1===ae.value.length&&$.value>1&&$.value--,pe())}))})(e.row)},{default:l((()=>[t("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),u("div",H,[s(ye,{"current-page":$.value,"page-size":ee.value,"page-sizes":[10,30,50,100],total:M.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:se,onSizeChange:ie},null,8,["current-page","page-size","total"])])]),s(he,{modelValue:ve.value,"onUpdate:modelValue":p[10]||(p[10]=e=>ve.value=e),size:"60%","before-close":Be,"show-close":!1},{title:l((()=>[u("div",K,[u("span",L,f(me.value),1),u("div",null,[s(j,{onClick:Be},{default:l((()=>[t("取 消")])),_:1}),s(j,{type:"primary",onClick:ge},{default:l((()=>[t("确 定")])),_:1})])])])),default:l((()=>[s(V,{title:"新增API，需要在角色管理内配置权限才可使用"}),s(x,{ref_key:"apiForm",ref:ce,model:W.value,rules:Z.value,"label-width":"80px"},{default:l((()=>[s(E,{label:"路径",prop:"path"},{default:l((()=>[s(h,{modelValue:W.value.path,"onUpdate:modelValue":p[6]||(p[6]=e=>W.value.path=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),s(E,{label:"请求",prop:"method"},{default:l((()=>[s(_,{modelValue:W.value.method,"onUpdate:modelValue":p[7]||(p[7]=e=>W.value.method=e),placeholder:"请选择",style:{width:"100%"}},{default:l((()=>[(e(!0),n(d,null,c(X.value,(l=>(e(),a(A,{key:l.value,label:"".concat(l.label,"(").concat(l.value,")"),value:l.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),s(E,{label:"api分组",prop:"apiGroup"},{default:l((()=>[s(h,{modelValue:W.value.apiGroup,"onUpdate:modelValue":p[8]||(p[8]=e=>W.value.apiGroup=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),s(E,{label:"api简介",prop:"description"},{default:l((()=>[s(h,{modelValue:W.value.description,"onUpdate:modelValue":p[9]||(p[9]=e=>W.value.description=e),autocomplete:"off"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-1d307b4e"]]);export{Q as default};
