/*! 
 Build based on gin-vue-admin 
 Time : 1718987800000 */
import{_ as e,a,ae as t,o as i,c as o,b as s,d as l,w as n,g as r,t as p,G as m,ap as c,k as d,l as u,E as B,am as g}from"./087AC4D233B64EB0index.72fd2312.js";/* empty css                                *//* empty css                                   *//* empty css                              *//* empty css                            *//* empty css                               *//* empty css                                  *//* empty css                               */import{E as C,a as E}from"./087AC4D233B64EB0table-column.a0d188fb.js";import"./087AC4D233B64EB0checkbox.ca4c4f80.js";/* empty css                                *//* empty css                               */import{_ as v,U as A,g as j,d as D,e as f}from"./087AC4D233B64EB0common.3f12f33f.js";import{C as w}from"./087AC4D233B64EB0index.60640113.js";import{f as h}from"./087AC4D233B64EB0format.44101a7e.js";import{_ as y}from"./087AC4D233B64EB0warningBar.90f1d9d1.js";import{E as _}from"./087AC4D233B64EB0index.ea000fb0.js";import{E as x}from"./087AC4D233B64EB0index.111d928a.js";import"./087AC4D233B64EB0index.ffab591b.js";import"./087AC4D233B64EB0index.a0571a5c.js";import"./087AC4D233B64EB0isUndefined.d281c39a.js";import"./087AC4D233B64EB0_baseIteratee.e71013e5.js";import"./087AC4D233B64EB0_Uint8Array.d3e78e14.js";import"./087AC4D233B64EB0isEqual.add17071.js";import"./087AC4D233B64EB0hasIn.391c448e.js";import"./087AC4D233B64EB0debounce.1e721c0b.js";import"./087AC4D233B64EB0_initCloneObject.253b0cea.js";/* empty css                               *//* empty css                                 *//* empty css                                                                              */import"./087AC4D233B64EB0index.e6ff289d.js";import"./087AC4D233B64EB0index.063cc7d2.js";import"./087AC4D233B64EB0cloneDeep.182936bd.js";import"./087AC4D233B64EB0_baseClone.503fbc91.js";/* empty css                                     */import"./087AC4D233B64EB0index.708655ee.js";import"./087AC4D233B64EB0date.225eaf4f.js";import"./087AC4D233B64EB0dictionary.cf01d2cf.js";import"./087AC4D233B64EB0sysDictionary.8a34cf5d.js";import"./087AC4D233B64EB0index.3d51996d.js";import"./087AC4D233B64EB0strings.ee229cfb.js";const b=(e,a)=>{var t=new Image;t.setAttribute("crossOrigin","anonymous"),t.onload=function(){var e=document.createElement("canvas");e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0,t.width,t.height);var i=e.toDataURL("image/png"),o=document.createElement("a"),s=new MouseEvent("click");o.download=a||"photo",o.href=i,o.dispatchEvent(s)},t.src=e},k={class:"gva-table-box"},z={class:"gva-btn-list"},U=["onClick"],O={class:"gva-pagination"},I=e(Object.assign({name:"Upload"},{__name:"upload",setup(e){const I=a("/api"),S=a(""),T=a(""),V=a(1),G=a(0),L=a(10),M=a({}),q=a([]),F=e=>{L.value=e,J()},H=e=>{V.value=e,J()},J=async()=>{const e=await j({page:V.value,pageSize:L.value,...M.value});0===e.code&&(q.value=e.data.list,G.value=e.data.total,V.value=e.data.page,L.value=e.data.pageSize)};J();return(e,a)=>{const j=u,K=B,P=C,R=_,W=E,X=x,Y=g;return t((i(),o("div",null,[s("div",k,[l(y,{title:"点击“文件名/备注”可以编辑文件名或者备注内容。"}),s("div",z,[l(v,{"image-common":T.value,onOnSuccess:J},null,8,["image-common"]),l(A,{"image-url":S.value,"file-size":512,"max-w-h":1080,onOnSuccess:J},null,8,["image-url"]),l(j,{modelValue:M.value.keyword,"onUpdate:modelValue":a[0]||(a[0]=e=>M.value.keyword=e),class:"keyword",placeholder:"请输入文件名或备注"},null,8,["modelValue"]),l(K,{type:"primary",icon:"search",onClick:J},{default:n((()=>[r("查询")])),_:1})]),l(W,{data:q.value},{default:n((()=>[l(P,{align:"left",label:"预览",width:"100"},{default:n((e=>[l(w,{"pic-type":"file","pic-src":e.row.url,preview:""},null,8,["pic-src"])])),_:1}),l(P,{align:"left",label:"日期",prop:"UpdatedAt",width:"180"},{default:n((e=>[s("div",null,p(m(h)(e.row.UpdatedAt)),1)])),_:1}),l(P,{align:"left",label:"文件名/备注",prop:"name",width:"180"},{default:n((e=>[s("div",{class:"name",onClick:a=>(async e=>{c.prompt("请输入文件名或者备注","编辑",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"不能为空",inputValue:e.name}).then((async({value:a})=>{e.name=a,0===(await f(e)).code&&(d({type:"success",message:"编辑成功!"}),J())})).catch((()=>{d({type:"info",message:"取消修改"})}))})(e.row)},p(e.row.name),9,U)])),_:1}),l(P,{align:"left",label:"链接",prop:"url","min-width":"300"}),l(P,{align:"left",label:"标签",prop:"tag",width:"100"},{default:n((e=>[l(R,{type:"jpg"===e.row.tag?"info":"success","disable-transitions":""},{default:n((()=>[r(p(e.row.tag),1)])),_:2},1032,["type"])])),_:1}),l(P,{align:"left",label:"操作",width:"160"},{default:n((e=>[l(K,{icon:"download",type:"primary",link:"",onClick:a=>{var t;(t=e.row).url.indexOf("http://")>-1||t.url.indexOf("https://")>-1?b(t.url,t.name):b(I.value+"/"+t.url,t.name)}},{default:n((()=>[r("下载")])),_:2},1032,["onClick"]),l(K,{icon:"delete",type:"primary",link:"",onClick:a=>(async e=>{c.confirm("此操作将永久删除文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{0===(await D(e)).code&&(d({type:"success",message:"删除成功!"}),1===q.value.length&&V.value>1&&V.value--,J())})).catch((()=>{d({type:"info",message:"已取消删除"})}))})(e.row)},{default:n((()=>[r("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),s("div",O,[l(X,{"current-page":V.value,"page-size":L.value,"page-sizes":[10,30,50,100],style:{float:"right",padding:"20px"},total:G.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:H,onSizeChange:F},null,8,["current-page","page-size","total"])])])])),[[Y,e.fullscreenLoading,void 0,{fullscreen:!0,lock:!0}]])}}}),[["__scopeId","data-v-2bc8c524"]]);export{I as default};
